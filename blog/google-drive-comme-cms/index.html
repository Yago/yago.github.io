<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Google Drive comme CMS !</title>
    <meta name="description" content="">
    <meta name="keywords" content="HTML,CSS,XML,JavaScript">
    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" href="/css/vendors.min.css">
    <link rel="stylesheet" href="/css/types.css">
    <link rel="stylesheet" href="/css/main.css">

    <script src="https://use.typekit.net/cwx4xcg.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div id="main" class="main-wrapper">
      <div id="content-wrapper" class="content-wrapper">
        <header>
  <a href="/">
    <img class="logo" src="/svg/yago-logo.svg" onerror="this.onerror=null; this.src='/img/yago-logo.png'" alt="Yago logotype" />
  </a>

  <button type="button" class="console-toggle" id="console-toggle">
  <span class="sr-only">Toggle console</span>
  <span></span>
  <span></span>
</button>

  <button type="button" class="menu-toggle" id="menu-toggle">
  <span class="sr-only">Toggle navigation</span>
  <span></span>
  <span></span>
  <span></span>
</button>

</header>

        <div class="smooth-content" id="smooth-content">
          
  <div class="text-center">
    <ol class="breadcrumb">
      <li><a href="/"><i class="icon icon-tipi"></i></a></li>
      <li>
        
          <a href="/blog/1">blog</a>
        
      </li>
      <li class="active">Google Drive comme CMS !</li>
    </ol>
  </div>

  
    <div class="cover">
      <img src="/img/cover/google-drive-comme-cms.jpg">
      <div class="inset-shadow"></div>
    </div>
  

  <div class="article-container" id="article-container">
    <div class="text-center">
      <h1>Google Drive comme CMS !</h1>
      <div class="date">
        11.03.2014 &bullet; Yann Gouffon
      </div>
    </div>

    <article id="article">
      <p>N&apos;avez-vous jamais r&#xEA;v&#xE9; de mettre en place une petite administration pour votre site afin d&apos;y ajouter ou d&apos;y modifier du contenu sans douleur ? Maintenant, avec Google, c&apos;est possible !</p>
<p>Google, avec son Drive, propose en effet de cr&#xE9;er et de stocker dans le cloud des documents de plusieurs types diff&#xE9;rents; des documents textes, des tableurs, des pr&#xE9;sentations et m&#xEA;me des formulaires. Dans notre cas, nous allons utiliser les formulaires et les tableurs, ou &quot;spreadsheet&quot;.</p>
<h2 id="le-concept">Le concept</h2>
<p>Comme dans une administration classique, nous allons utiliser un formulaire, li&#xE9; &#xE0; une spreadsheet o&#xF9; nous irons rechercher les donn&#xE9;es pr&#xE9;c&#xE9;demment entr&#xE9;es. </p>
<blockquote>
<p>Quelle diff&#xE9;rence avec une base de donn&#xE9;e ?</p>
</blockquote>
<p>Aucune, le syst&#xE8;me est le m&#xEA;me, mais l&apos;avantage de ce syst&#xE8;me est sa rapidit&#xE9; de mise en place. On pourra donc l&apos;utiliser pour une quantit&#xE9; r&#xE9;duite de donn&#xE9;es et une structure &#xE0; une table.</p>
<p>Dans notre exemple, nous allons cr&#xE9;er une petite administration afin d&apos;ajouter et d&apos;afficher la liste des membres de notre association (fictive).</p>
<h2 id="ajouter-des-membres">Ajouter des membres</h2>
<p>Pour cela, nous allons commencer par cr&#xE9;er un nouveau formulaire que nous nommerons &quot;Ajout de membres&quot; avec les champs nom, pr&#xE9;nom et E-mail. Ensuite, avec &quot;Choisir une destination pour la r&#xE9;ponse&quot;, nous allons lui assigner une nouvelle spreadsheet que nous nommerons &quot;Liste des membres&quot;.</p>
<p>Maintenant, vous pourriez tr&#xE8;s bien partager le <a href="https://docs.google.com/forms/d/1Le-duty7sC7hRU5vidzYpeMT_Ww7s5mU3c4k4VjXU8k/viewform">lien vers votre formulaire</a> ou simplement l&apos;int&#xE9;grer sur votre site au moyen de l&apos;iframe propos&#xE9;. Mais dans les deux cas, l&apos;aspect visuel resterra peu convaincant.</p>
<p>Pour int&#xE9;grer le formulaire directement sur notre site, il nous suffit de visiter le formulaire comme si nous souhaitions le remplir, puis, en affichant le code source de la page, copier simplement tout l&apos;&#xE9;l&#xE9;ment formulaire et le coller dans notre code.</p>
<p>Nous devrions donc avoir quelque chose comme &#xE7;a :</p>
<pre class="line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://docs.google.com/forms/d/1Le-duty7sC7hRU5vidzYpeMT_Ww7s5mU3c4k4VjXU8k/formResponse<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ss-form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>_self<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Maintenant, vous constaterez surement qu&apos;apr&#xE8;s la soumission, nous nous retrouvons avec la m&#xEA;me page toute moche de confirmation.</p>
<p>Pour d&#xE9;finir une page de confirmation diff&#xE9;rente, il nous suffit de remplacer le :</p>
<pre class="line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://docs.google.com/forms/d/1Le-duty7sC7hRU5vidzYpeMT_Ww7s5mU3c4k4VjXU8k/formResponse<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ss-form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>_self<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>par :</p>
<pre class="line-numbers"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"><span class="token keyword">var</span> submitted<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hidden_iframe<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hidden_iframe<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>if(submitted) {window.location<span class="token punctuation">=</span><span class="token punctuation">&apos;</span>http://mon-site.com/ma-page-de-confirmation.html<span class="token punctuation">&apos;</span>;}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://docs.google.com/forms/d/1Le-duty7sC7hRU5vidzYpeMT_Ww7s5mU3c4k4VjXU8k/formResponse<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>hidden_iframe<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>submitted<span class="token punctuation">=</span>true;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Nous voici pr&#xE8;s &#xE0; rentrer nos membres ! Maintenant, si nous souhaitions &#xEA;tre les seuls &#xE0; pouvoir acc&#xE9;der &#xE0; ce formulaire comme dans une administration classique, rien ne nous emp&#xEA;che de le placer dans un r&#xE9;pertoire prot&#xE9;g&#xE9; par un .htpasswd.</p>
<h2 id="afficher-les-membres">Afficher les membres</h2>
<p>Avant toute chose, il nous faut nous rendre dans notre spreadsheet de r&#xE9;sultats et la rendre consultable avec le lien (option de partage). Puis, dans Fichier/Publier sur le Web, nous allons d&#xE9;marrer la publication. Ce sera cette publication, duplicata de notre spreadsheet, qui sera utilis&#xE9;e pour afficher les donn&#xE9;es. N&apos;oubliez pas de recopier la cl&#xE9; de votre document.</p>
<p>La suite est assez simple et m&#xEA;me les profanes &#xE0; PHP comprendront ! Nous allons simplement r&#xE9;cup&#xE9;rer le JSON sortant de la spreasheet et afficher les &#xE9;l&#xE9;ments ligne par ligne.</p>
<p>Pour r&#xE9;cup&#xE9;rer le JSON (en PHP) :</p>
<pre class="line-numbers"><code class="language-php"><span class="token comment" spellcheck="true">// Cl&#xE9; de la spreadsheet</span>
<span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string">&apos;0AmViBjefqXQgdG43QVJpcUhDeXU1NGpWSS1DWW9RNkE&apos;</span><span class="token punctuation">;</span>

<span class="token variable">$spreadsheet</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span>&apos;https<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//spreadsheets.google.com/feeds/list/%s/1/public/values?alt=json&apos;, $key);</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$spreadsheet</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Maintenant, il ne reste plus qu&apos;&#xE0; faire une boucle sur chaque ligne et d&apos;en afficher le contenu. En l&apos;occurrence nous voulons afficher le pr&#xE9;nom et le nom de nos membres, ainsi qu&apos;un lien vers son adresse e-mail.</p>
<pre class="line-numbers"><code class="language-php"><span class="token comment" spellcheck="true">// Pour chaque ligne (entr&#xE9;e) du tableau :</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">&apos;feed&apos;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;entry&apos;</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">echo</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">&apos;gsx$pr&#xE9;nom&apos;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;$t&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">&apos; &apos;</span><span class="token punctuation">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">&apos;gsx$nom&apos;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;$t&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>&apos;<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span></span>&apos;<span class="token punctuation">;</span>
  <span class="token keyword">echo</span> &apos;<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mailto:<span class="token punctuation">&apos;</span>.$row[<span class="token punctuation">&apos;</span>gsx$e-mail<span class="token punctuation">&apos;</span>][<span class="token punctuation">&apos;</span>$t<span class="token punctuation">&apos;</span>].<span class="token punctuation">&apos;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span><span class="token string">&apos;.$row[&apos;</span>gsx<span class="token variable">$e</span><span class="token operator">-</span>mail<span class="token string">&apos;][&apos;</span><span class="token variable">$t</span><span class="token string">&apos;].&apos;</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span></span>&apos;<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>On peut bien &#xE9;videmment aller plus loin dans la complexit&#xE9;, jusqu&apos;&#xE0; cr&#xE9;er un petit moteur de blog sur ce principe. N&#xE9;anmoins, il reste plus ad&#xE9;quat d&apos;utiliser une &quot;vraie&quot; base de donn&#xE9;es dans le cas d&apos;un site plus complexe.</p>
<p>L&apos;avantage de ce syst&#xE8;me r&#xE9;side dans le fait que les donn&#xE9;es restent accessibles et &#xE9;ditables directement &#xE0; la source pour le client. Il pourra, en effet, y faire directement ses modifications, mais aussi changer le statut d&apos;une ligne en passant une valeur de TRUE &#xE0; FALSE par exemple <img align='absmiddle' alt=':wink:' class='emoji' src='/img/emojis/wink.png' title=':wink:' /></p>
<p><a href="http://antistatique.net/blog/2014/03/11/google-drive-comme-cms/">Retrouver cet article sur le blog d&apos;Antistatique !</a></p>

    </article>

    
      <div class="spacer spacer-xs"></div>
      <hr>
      <div class="spacer spacer-xs"></div>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'yago-io'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
  </div>


        </div>
        <footer>
  <div class="container text-center">
    <div class="row">
      <div class="col-sm-8 col-sm-offset-2">
        <div class="separator">
  <i class="icon icon-drakar"></i>
</div>


        <p>
          <em>Let's keep in touch !</em>
        </p>

        <ul>
          <li>
            <i class="icon icon-github-alt"></i> <a href="https://github.com/yago" target="_blank">Github</a>
          </li>
          <li>
            <i class="icon icon-twitter"></i> <a href="https://twitter.com/Yago_0" target="_blank">Twitter</a>
          </li>
          <li>
            <i class="icon icon-linkedin"></i> <a href="https://ch.linkedin.com/in/yanngouffon" target="_blank">LinkedIn</a>
          </li>
          <li>
            <i class="icon icon-instagram"></i> <a href="https://www.instagram.com/yago_0/" target="_blank">Instagram</a>
          </li>
          <li>
            <i class="icon icon-send"></i> <a href="mailto:hello@yago.io" target="_blank">Email</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</footer>

      </div>
      <div id="console-wrapper" class="side-wrapper console-wrapper">
  <div id="console" class="console"></div>
</div>

      <div id="menu-wrapper" class="side-wrapper menu-wrapper">
  <div id="menu" class="menu">
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/projects">Projects</a></li>
      <li><a href="/blog/1">Blog</a></li>
      <li><i class="icon icon-bonsai"></i></li>
    </ul>
  </div>
</div>

    </div>

    
      <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
  <!-- Background of PhotoSwipe.
     It's a separate element as animating opacity is faster than rgba(). -->
  <div class="pswp__bg"></div>
  <!-- Slides wrapper with overflow:hidden. -->
  <div class="pswp__scroll-wrap">
    <!-- Container that holds slides.
      PhotoSwipe keeps only 3 of them in the DOM to save memory.
      Don't modify these 3 pswp__item elements, data is added later on. -->
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
    <div class="pswp__ui pswp__ui--hidden">
      <div class="pswp__top-bar">
        <!--  Controls are self-explanatory. Order can be changed. -->
        <div class="pswp__counter"></div>
        <button class="pswp__button pswp__button--close" title="Close (Esc)">
          <i class="icon icon-close"></i>
        </button>
        <button class="pswp__button pswp__button--fs" title="Toggle fullscreen">
          <i class="icon icon-fullscreen"></i>
        </button>
        <button class="pswp__button pswp__button--zoom" title="Zoom in/out">
          <i class="icon icon-search"></i>
        </button>
        <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
        <!-- element will get class pswp__preloader--active when preloader is running -->
        <div class="pswp__preloader">
          <div class="pswp__preloader__icn">
            <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
        <div class="pswp__share-tooltip"></div>
      </div>
      <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
        <i class="icon icon-left"></i>
      </button>
      <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
        <i class="icon icon-right"></i>
      </button>
      <div class="pswp__caption">
        <div class="pswp__caption__center"></div>
      </div>
    </div>
  </div>
</div>

    

    <script src="/js/vendors.min.js"></script>
    <script src="/js/main.js"></script>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-41124823-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
